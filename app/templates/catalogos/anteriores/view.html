{% extends 'base.html' %}
{% block content %}
<h2>Catálogo: {{ catalog.name }}</h2>

<p><strong>Columnas:</strong> {{ catalog.headers | join(', ') }}</p>

<div class="mb-3">
  <a href="{{ url_for('catalogs.edit', catalog_id=catalog._id) }}" class="btn btn-warning">Editar catálogo</a>
  <a href="{{ url_for('catalogs.import_catalog') }}" class="btn btn-secondary">Importar nuevo</a>
  <a href="{{ url_for('catalogs.create') }}" class="btn btn-success">Crear nuevo catálogo</a>
  <a href="{{ url_for('catalogs.list') }}" class="btn btn-outline-dark">Volver al listado</a>
</div>

<h4>Filas:</h4>
<table class="table table-striped">
  <thead>
    <tr>
      {% for header in catalog.headers %}
        <th>{{ header }}</th>
      {% endfor %}
      <th>Acciones</th>
    </tr>
  </thead>
  <tbody>
    {% for row in catalog.rows %}
    <tr>
      {% for header in catalog.headers %}
        <td>{{ row[header] }}</td>
      {% endfor %}
      <td>
        <a href="{{ url_for('catalogs.edit_row', catalog_id=catalog._id, row_index=loop.index0) }}" class="btn btn-sm btn-outline-primary">Editar</a>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<hr>

<h4>Imágenes</h4>
{% if catalog.imagenes %}
  <div class="row">
    {% for imagen in catalog.imagenes %}
      <div class="col-md-3 mb-3">
        <img src="/imagenes_subidas/{{ imagen }}" class="img-fluid" alt="Imagen {{ loop.index }}">
      </div>
    {% endfor %}
  </div>
{% else %}
  <p>No hay imágenes para este catálogo.</p>
{% endif %}

<form action="{{ url_for('images.upload_images', catalog_id=catalog._id) }}" method="post" enctype="multipart/form-data" class="mt-3">
  <div class="mb-3">
    <label for="images" class="form-label">Subir hasta 3 imágenes</label>
    <input type="file" name="images" multiple class="form-control" accept="image/*">
  </div>
  <button type="submit" class="btn btn-primary">Subir imágenes</button>
</form>
{% endblock %}
