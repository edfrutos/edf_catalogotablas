{% extends 'base.html' %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
  <h2>Usuarios Registrados</h2>
  <div>
    {% if session.rol == 'admin' %}
      <a href="{{ url_for('admin.dashboard_admin') }}" class="btn btn-secondary">Volver al Panel de Administración</a>
    {% else %}
      <a href="{{ url_for('main.dashboard') }}" class="btn btn-secondary">Volver al Panel de Control</a>
    {% endif %}
    <a href="{{ url_for('admin.crear_usuario') }}" class="btn btn-primary">Crear Nuevo Usuario</a>
  </div>
</div>

<table class="table table-striped">
  <thead>
    <tr>
      <th>Nombre</th>
      <th>Email</th>
      <th>Rol</th>
      <th>Catálogos/Tablas</th>
      <th>Acciones</th>
    </tr>
  </thead>
  <tbody>
    {% for usuario in usuarios %}
    <tr>
      <td>{{ usuario.nombre }}</td>
      <td>{{ usuario.email }}</td>
      <td>{{ usuario.role }}</td>
      <td>
        <a href="{{ url_for('admin.ver_catalogos_usuario', user_id=usuario._id) }}" class="btn btn-link">
          {{ usuario.num_catalogs }}
        </a>
      </td>
      <td>
        <a href="{{ url_for('admin.editar_usuario', user_id=usuario._id) }}" class="btn btn-sm btn-primary">Editar</a>
        <form action="{{ url_for('admin.eliminar_usuario', user_id=usuario._id) }}" method="POST" class="d-inline" onsubmit="return confirm('¿Estás seguro de que quieres eliminar este usuario?')">
          <button type="submit" class="btn btn-sm btn-danger">Eliminar</button>
        </form>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}
