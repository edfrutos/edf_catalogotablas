<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prueba Modal Google Drive</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <h1>Prueba del Modal Google Drive</h1>
        <p>Esta p√°gina prueba si el modal funciona correctamente con las correcciones aplicadas.</p>
        
        <div class="card">
            <div class="card-header">
                <h5>Backup y restauraci√≥n</h5>
            </div>
            <div class="card-body">
                <p>Haz clic en el bot√≥n Google Drive para probar el modal:</p>
                
                <!-- Bot√≥n Google Drive con atributos Bootstrap correctos -->
                <button class="btn btn-outline-success ms-2" id="restoreDriveBtn"
                        data-bs-toggle="modal" data-bs-target="#restoreDriveModal">
                    <i class="bi bi-google"></i> Google Drive
                </button>
                
                <div class="mt-3">
                    <p><strong>Estado esperado:</strong></p>
                    <ul>
                        <li>‚úÖ jQuery cargado</li>
                        <li>‚úÖ Bootstrap cargado</li>
                        <li>‚úÖ Bot√≥n con atributos correctos</li>
                        <li>‚úÖ Modal HTML presente</li>
                        <li>‚úÖ Event listeners configurados</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Google Drive (copiado exactamente del dashboard) -->
    <div class="modal fade" id="restoreDriveModal" tabindex="-1" aria-labelledby="restoreDriveModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="restoreDriveModalLabel">
                        <i class="bi bi-google-drive"></i> Restaurar desde Google Drive
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                </div>
                <div class="modal-body">
                    <div id="driveBackupsLoading" class="text-center py-4">
                        <div class="spinner-border text-primary" role="status">
                            <span class="visually-hidden">Cargando...</span>
                        </div>
                        <p class="mt-2">Cargando backups disponibles...</p>
                    </div>
                    <div id="driveBackupsContent" style="display: none;">
                        <p class="mb-3">Selecciona el backup que deseas restaurar:</p>
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>Archivo</th>
                                        <th>Tama√±o</th>
                                        <th>Fecha</th>
                                        <th>Acci√≥n</th>
                                    </tr>
                                </thead>
                                <tbody id="driveBackupsList">
                                    <tr>
                                        <td>
                                            <i class="bi bi-file-earmark-zip"></i> 
                                            <strong>backup_ejemplo.json</strong>
                                            <br><small class="text-muted">Por: Sistema</small>
                                        </td>
                                        <td>2.5 MB</td>
                                        <td>18/01/2025 12:30</td>
                                        <td>
                                            <button class="btn btn-success btn-sm">
                                                <i class="bi bi-arrow-counterclockwise"></i> Restaurar
                                            </button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div id="driveBackupsError" style="display: none;" class="alert alert-warning">
                        <h6><i class="bi bi-exclamation-triangle"></i> No se pudieron cargar los backups</h6>
                        <p class="mb-2">Puedes introducir manualmente la URL del backup:</p>
                        <input type="url" class="form-control" id="driveUrlInput" placeholder="https://drive.google.com/file/d/.../view?usp=sharing">
                        <button type="button" class="btn btn-success mt-2" id="confirmRestoreDriveUrlBtn">
                            <i class="bi bi-arrow-counterclockwise"></i> Restaurar desde URL
                        </button>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-outline-primary" id="refreshDriveBackupsBtn">
                        <i class="bi bi-arrow-clockwise"></i> Actualizar lista
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts: jQuery + Bootstrap + JavaScript personalizado -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        $(document).ready(function() {
            console.log('‚úÖ jQuery cargado:', typeof $ !== 'undefined');
            console.log('‚úÖ Bootstrap cargado:', typeof bootstrap !== 'undefined');
            console.log('‚úÖ Bot√≥n encontrado:', $('#restoreDriveBtn').length > 0);
            console.log('‚úÖ Modal encontrado:', $('#restoreDriveModal').length > 0);
            
            // Funci√≥n para cargar backups (simulada)
            function loadDriveBackups() {
                console.log('üì° Cargando backups de Google Drive...');
                $("#driveBackupsLoading").show();
                $("#driveBackupsContent, #driveBackupsError").hide();
                
                // Simular carga despu√©s de 2 segundos
                setTimeout(function() {
                    $("#driveBackupsLoading").hide();
                    $("#driveBackupsContent").show();
                    console.log('‚úÖ Backups cargados correctamente');
                }, 2000);
            }
            
            // Event listener para el bot√≥n Google Drive
            $("#restoreDriveBtn").off("click").on("click", function () {
                console.log('üñ±Ô∏è Bot√≥n Google Drive clickeado');
                var modal = new bootstrap.Modal(document.getElementById("restoreDriveModal"));
                modal.show();
                loadDriveBackups();
            });
            
            // Event listener para actualizar lista
            $(document).off("click", "#refreshDriveBackupsBtn").on("click", "#refreshDriveBackupsBtn", function() {
                console.log('üîÑ Actualizando lista de backups');
                loadDriveBackups();
            });
            
            console.log('üöÄ JavaScript inicializado correctamente');
        });
    </script>
</body>
</html>
