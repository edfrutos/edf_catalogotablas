<!-- Script de debug espec√≠fico para inyectar en la p√°gina real -->
<script>
console.log("=== üîß DEBUG ESPEC√çFICO BOTONES BACKUP ===");

// Test espec√≠fico para el bot√≥n de backup que no responde
function debugBackupButton() {
    console.log("üîç Analizando bot√≥n de backup...");
    
    const btn = $("#backupBtn");
    if (btn.length === 0) {
        console.error("‚ùå Bot√≥n #backupBtn no encontrado");
        return;
    }
    
    console.log("‚úÖ Bot√≥n encontrado:", btn);
    console.log("üìã Atributos del bot√≥n:", {
        id: btn.attr('id'),
        class: btn.attr('class'),
        disabled: btn.prop('disabled'),
        visible: btn.is(':visible')
    });
    
    // Verificar eventos asignados
    const events = $._data(btn[0], "events");
    console.log("üéØ Eventos asignados:", events);
    
    if (!events || !events.click) {
        console.error("‚ùå NO HAY EVENTOS CLICK asignados al bot√≥n");
        console.log("üí° Asignando evento de prueba...");
        
        // Asignar evento manualmente
        btn.off('click').on('click', function() {
            console.log("‚úÖ Click detectado - ejecutando backup...");
            
            $(this).prop("disabled", true).html("üîÑ Procesando...");
            
            $.ajax({
                url: "/maintenance/api/backup",
                method: "POST",
                xhrFields: { withCredentials: true },
                success: function(response) {
                    console.log("‚úÖ Backup exitoso:", response);
                    alert("Backup realizado correctamente!");
                },
                error: function(xhr, status, error) {
                    console.error("‚ùå Error:", status, error, xhr.responseText);
                    alert("Error en backup: " + status + " - " + error);
                },
                complete: function() {
                    btn.prop("disabled", false).html('<i class="bi bi-cloud-arrow-up"></i> Realizar Backup');
                }
            });
        });
        
        console.log("‚úÖ Evento de backup asignado manualmente");
    } else {
        console.log("‚úÖ Eventos encontrados, probando click...");
        btn.click();
    }
}

// Test espec√≠fico para el bot√≥n de Google Drive que oscurece pantalla
function debugGoogleDriveButton() {
    console.log("üîç Analizando bot√≥n de Google Drive...");
    
    const btn = $("#restoreDriveBtn");
    if (btn.length === 0) {
        console.error("‚ùå Bot√≥n #restoreDriveBtn no encontrado");
        return;
    }
    
    console.log("‚úÖ Bot√≥n encontrado:", btn);
    console.log("üìã Atributos del bot√≥n:", {
        'data-bs-toggle': btn.attr('data-bs-toggle'),
        'data-bs-target': btn.attr('data-bs-target'),
        class: btn.attr('class')
    });
    
    // Verificar si el modal existe
    const modalId = btn.attr('data-bs-target');
    const modal = $(modalId);
    console.log("ü™ü Modal target:", modalId, "exists:", modal.length > 0);
    
    if (modal.length === 0) {
        console.error("‚ùå Modal no encontrado:", modalId);
        console.log("üí° Creando modal de prueba...");
        
        // Crear modal b√°sico si no existe
        const modalHtml = `
        <div class="modal fade" id="restoreDriveModal" tabindex="-1">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Google Drive Backup</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body">
                        <p>Modal de prueba para Google Drive</p>
                    </div>
                </div>
            </div>
        </div>
        `;
        $('body').append(modalHtml);
        console.log("‚úÖ Modal de prueba creado");
    }
}

// Ejecutar tests
debugBackupButton();
debugGoogleDriveButton();

console.log("\nüí° Comandos disponibles:");
console.log("‚Ä¢ debugBackupButton() - Analizar bot√≥n backup");
console.log("‚Ä¢ debugGoogleDriveButton() - Analizar bot√≥n Google Drive");

// Hacer funciones disponibles globalmente
window.debugBackupButton = debugBackupButton;
window.debugGoogleDriveButton = debugGoogleDriveButton;
</script>
